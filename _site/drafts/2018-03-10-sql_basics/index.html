<h3 id="1-主要数据库类型">1 主要数据库类型</h3>

<ul>
  <li>Relational database - <a href="https://zh.wikipedia.org/wiki/%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93">关系型数据库</a>。
    <ul>
      <li>SQLite</li>
      <li>MySQL</li>
      <li>PostgreSQL</li>
      <li>Oracle</li>
      <li>Microsoft SQL</li>
      <li>…</li>
    </ul>
  </li>
  <li><a href="https://zh.wikipedia.org/wiki/NoSQL">NoSQL 类型数据库</a>。
    <ul>
      <li>MongoDB</li>
      <li>CouchBase</li>
      <li>Redis</li>
      <li>…</li>
    </ul>
  </li>
</ul>

<p>区别：</p>
<ul>
  <li>关系型数据需要使用 SQL Structured Query Language 进行查询。</li>
  <li>NoSQL 可以不使用 SQL 进行查询</li>
</ul>

<p><em><a href="https://en.wikipedia.org/wiki/NoSQL#Types_and_examples_of_NoSQL_databases">后者用不同的分类标准又分为很多种类型</a></em></p>

<p>From wikipedia:</p>
<blockquote>
  <p>NoSQL systems are also sometimes called “Not only SQL” to emphasize that they may support SQL-like query languages</p>
</blockquote>

<hr />

<p><strong>基本操作类型</strong></p>

<p>Four Main Data Operations</p>
<ul>
  <li>Create</li>
  <li>Read</li>
  <li>Update</li>
  <li>Delete</li>
</ul>

<hr />
<h3 id="2-structured-query-language">2 Structured Query Language</h3>

<blockquote>
  <p>A database can be considered a structure in realization
of the database language.
                                        - Rybinski,H.</p>
</blockquote>

<p><strong>基本结构 - table</strong></p>

<p>table == column * row</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">column1</th>
      <th style="text-align: center">column2</th>
      <th style="text-align: center">column3</th>
      <th>…</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td> </td>
      <td>row1</td>
    </tr>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td> </td>
      <td>row2</td>
    </tr>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td> </td>
      <td>row3</td>
    </tr>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td> </td>
      <td>…</td>
    </tr>
  </tbody>
</table>

<p>SQL的复杂变化都是基于table这个基本结构构建起来的。</p>

<p>含有信息的table:</p>

<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fpejsettb4j30na0a9my5.jpg" alt="" /></p>

<p><strong>Types of Data in SQL - SQL中的数据类型</strong></p>

<ul>
  <li>Text Type Examples 文本型
    <ul>
      <li>TEXT</li>
      <li>VARCHAR</li>
    </ul>
  </li>
  <li>Numeric Type Examples 数字型
    <ul>
      <li>INT</li>
      <li>INTEGER</li>
    </ul>
  </li>
  <li>Date Type Examples 日期型
    <ul>
      <li>DATETIME</li>
      <li>DATE</li>
      <li>TIMESTAMP</li>
    </ul>
  </li>
</ul>

<h3 id="3-basic-crud">3 Basic CRUD</h3>

<h3 id="31-read---query类句法">3.1 READ - Query类句法</h3>

<p><strong>Basic Syntax</strong></p>

<p>keywords(can be lowercase):</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">;</code> 分号是一个statement/query的结束标志</li>
  <li>AS 可以给sub query的结果命名（类似存入变数名称）</li>
  <li>SELECT</li>
  <li>FROM</li>
  <li><code class="language-plaintext highlighter-rouge">*</code> 代表 All</li>
  <li>WHERE 用来引出条件限制，通常会是一个条件式
    <ul>
      <li>operator 如 <code class="language-plaintext highlighter-rouge">=</code> <code class="language-plaintext highlighter-rouge">!=</code> <code class="language-plaintext highlighter-rouge">&gt;</code> <code class="language-plaintext highlighter-rouge">&lt;</code> <code class="language-plaintext highlighter-rouge">&lt;=</code> <code class="language-plaintext highlighter-rouge">&gt;=</code></li>
      <li>AND</li>
      <li>OR</li>
      <li>IN (通常与WHERE)配合使用</li>
      <li>NOT IN (通常与WHERE)配合使用</li>
      <li>BETWEEN … AND</li>
    </ul>
  </li>
</ul>

<p><strong>Retrieving Specific Columns of Information</strong></p>

<ul>
  <li>选择单个column时， column名称是bare word不用引号包裹, 直接跟在 <code class="language-plaintext highlighter-rouge">SELECT</code> 后。</li>
  <li>选择多个column时，各个column名称之间用逗号<code class="language-plaintext highlighter-rouge">,</code>隔开。</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">email</span> <span class="k">FROM</span> <span class="n">patrons</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">email</span><span class="p">,</span> <span class="n">phone</span> <span class="k">FROM</span> <span class="n">patrons</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">email</span><span class="p">,</span> <span class="n">phone</span><span class="p">,</span> <span class="n">zip_code</span> <span class="k">FROM</span> <span class="n">patrons</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>Categorizing Your Output with ‘AS’</strong></p>

<p>选择单个 column 时使用 <code class="language-plaintext highlighter-rouge">AS</code>，后面的new_name用引号包裹。</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">&lt;</span><span class="k">column_name</span><span class="o">&gt;</span> <span class="k">AS</span> <span class="o">&lt;</span><span class="n">new_name</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<p>选择多个 column 时使用 <code class="language-plaintext highlighter-rouge">AS</code>；</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">column_1</span><span class="o">&gt;</span> <span class="k">AS</span> <span class="o">&lt;</span><span class="n">new_name_1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">column_2</span><span class="o">&gt;</span> <span class="k">AS</span> <span class="o">&lt;</span><span class="n">new_name_2</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table_name</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<p>Tricks:</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">1+1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">2</td>
    </tr>
  </tbody>
</table>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">;</span>
</code></pre></div></div>
<p>|1+1|2+2|
|:-:|:-:|
|2|4|</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="mi">1</span><span class="o">+</span><span class="mi">1</span> <span class="k">AS</span> <span class="s1">'small'</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="mi">2</span> <span class="k">AS</span> <span class="s1">'big'</span><span class="p">;</span>
</code></pre></div></div>
<p>|small|big|
|:-:|:-:|
|2|4|</p>

<p><strong>Searching Tables with ‘WHERE’</strong></p>

<p>基本用法</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="n">condition</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<ul>
  <li>使用 conditon 时要注意 data type 的对应关系(数字类型不加引号)。</li>
  <li>condition 可以使用组合条件</li>
</ul>

<p>exmaples:</p>

<p>从contact中找出first_name是 ‘Andrew’ 的所有数据(返回结果包含所有column)</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">contacts</span> <span class="k">WHERE</span> <span class="n">first_name</span> <span class="o">=</span> <span class="nv">"Andrew"</span><span class="p">;</span>
</code></pre></div></div>

<p>从people中找出所有 age column 大于 19 的数据(包含所有column)。</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">people</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="mi">19</span><span class="p">;</span>
</code></pre></div></div>

<p>从people中找出所有 age column 大于 19 的项目的 name 和 age。</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span> <span class="k">FROM</span> <span class="n">people</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="mi">19</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>条件的组合</strong></p>

<p>基本用法</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="n">condition</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="k">AND</span> <span class="o">&lt;</span><span class="n">condition</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="p">...;</span>
<span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="n">condition</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="k">OR</span> <span class="o">&lt;</span><span class="n">condition</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="p">...;</span>
</code></pre></div></div>

<p>example:</p>

<p>从people表中找出所有gender为’female’, age小于22的条目的，name, phone, address</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">phone</span><span class="p">,</span> <span class="n">address</span> <span class="k">FROM</span> <span class="n">people</span> <span class="k">WHERE</span> <span class="n">gender</span> <span class="o">=</span> <span class="s1">'female'</span> <span class="k">AND</span> <span class="n">age</span> <span class="o">&lt;</span> <span class="mi">22</span> <span class="p">...;</span>
</code></pre></div></div>

<p><strong>用日期作为过滤条件</strong></p>

<ul>
  <li>注意日期用引号包裹</li>
  <li><code class="language-plaintext highlighter-rouge">&gt;</code> date 代表这个日期之后的时间段</li>
  <li>日期格式 “YYYY-MM-DD”</li>
</ul>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">loans</span> <span class="k">WHERE</span> <span class="n">loaned_on</span> <span class="o">&lt;</span>  <span class="nv">"2015-12-13"</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>Searching in a Set of Values 用一个集合的值作为过滤条件</strong></p>

<ul>
  <li>IN</li>
  <li>NOT IN</li>
</ul>

<p>基本用法</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="k">column</span><span class="o">&gt;</span> <span class="k">IN</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">value</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">value</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...);</span>
</code></pre></div></div>

<p>找出id为 1,2,3,20 的数据</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">books</span> <span class="k">WHERE</span> <span class="n">id</span> <span class="k">IN</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">);</span>
</code></pre></div></div>
<p>给出集合中的条件并不一定必须存在于数据库中，最后拿到的是交集。上例子中如果books中并没有一个book条目的id等于20，那么就只返回前面三个匹配到的项目。</p>

<p><strong>Searching Within a Range of Values 使用range作为过滤条件</strong></p>

<ul>
  <li>BETWEEN … AND …</li>
</ul>

<p>基本用法</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="k">column</span><span class="o">&gt;</span> <span class="k">BETWEEN</span> <span class="o">&lt;</span><span class="n">lesser</span> <span class="n">value</span><span class="o">&gt;</span> <span class="k">AND</span> <span class="o">&lt;</span><span class="n">greater</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<p>找出books中id在 8 到 13 之间（包含端点值）的数据。</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">books</span> <span class="k">where</span> <span class="n">id</span> <span class="k">between</span> <span class="mi">8</span> <span class="k">and</span> <span class="mi">13</span><span class="p">;</span>
</code></pre></div></div>

<p>找出一个时间区间内出版的书</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">author</span> <span class="k">FROM</span> <span class="n">books</span> <span class="k">WHERE</span> <span class="n">published_at</span> <span class="k">BETWEEN</span> <span class="nv">"2015-01-01"</span> <span class="k">AND</span> <span class="nv">"2015-01-07"</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>使用 <code class="language-plaintext highlighter-rouge">LIKE</code> + <code class="language-plaintext highlighter-rouge">%</code> 进行模糊匹配</strong></p>

<p>基本用法</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="k">column</span><span class="o">&gt;</span> <span class="k">LIKE</span> <span class="o">&lt;</span><span class="n">pattern</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<p>从books中找出tile以’a story about’开头的书de title</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">title</span> <span class="k">FROM</span> <span class="n">books</span> <span class="k">WHERE</span> <span class="n">title</span> <span class="k">LIKE</span> <span class="nv">"A story about%"</span><span class="p">;</span>
</code></pre></div></div>

<p>LIKE算作condition的一种，所以可以和其他条件组合</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">title</span> <span class="k">FROM</span> <span class="n">books</span> <span class="k">WHERE</span> <span class="n">title</span> <span class="k">LIKE</span> <span class="nv">"A story about%"</span> <span class="k">AND</span> <span class="n">published_at</span> <span class="o">&gt;</span> <span class="s1">'2017-09-18'</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>NULL 作为查找条件</strong></p>

<ul>
  <li>IS NULL</li>
  <li>IS NOT NULL</li>
</ul>

<p>基本用法</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="k">column</span><span class="o">&gt;</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div></div>

<p>从books中找出co_author合著者为NULL的条目</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">title</span> <span class="k">FROM</span> <span class="n">books</span> <span class="k">WHERE</span> <span class="n">co_author</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div></div>

<p>IS NOT NULL：</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">people</span> <span class="k">WHERE</span> <span class="n">forte</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>跨table查找</strong></p>

<p>基本用法：</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">columns</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">table1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">table2</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="n">table1</span><span class="p">.</span><span class="n">column_x</span> <span class="o">=</span> <span class="n">table2</span><span class="p">.</span><span class="n">column_y</span><span class="p">;</span>
</code></pre></div></div>

<p>这个操作类似接表的操作，把books和movies中给出column中有交集的rows接起来</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">books</span><span class="p">,</span> <span class="n">movies</span> <span class="k">WHERE</span> <span class="n">books</span><span class="p">.</span><span class="n">genre</span> <span class="o">=</span> <span class="n">movies</span><span class="p">.</span><span class="k">type</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="32-create类句法">3.2 Create类句法</h3>

<p><strong>Keywords</strong></p>

<ul>
  <li>INSERT INTO</li>
  <li>VALUES</li>
</ul>

<p>注入单独一行</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">VALUES</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">value</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">value</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...);</span>
</code></pre></div></div>

<p>假设有books table, 有5个column</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">id</th>
      <th style="text-align: center">title</th>
      <th style="text-align: center">author</th>
      <th style="text-align: center">genre</th>
      <th style="text-align: center">first_published</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td style="text-align: center"> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p><strong>不给出column名称，只给value，按顺序注入</strong></p>

<ul>
  <li>限制是，给出的 value 数量以及顺和 column 在表中排布要一致，显然这不是一个省力的方法。</li>
  <li>直接给出一个具体的primary key的值可能引起冲突，由于id是自动增量的，所以id可以给出 <code class="language-plaintext highlighter-rouge">NULL</code></li>
</ul>

<p><strong>给出column名称和对应的值进行注入</strong></p>

<p>比如</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">books</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">first_published</span><span class="p">,</span> <span class="n">author</span><span class="p">)</span> <span class="k">VALUES</span> <span class="p">(</span><span class="k">NULL</span><span class="p">,</span> <span class="nv">"Blessing"</span><span class="p">,</span> <span class="nv">"2018-01-10"</span><span class="p">,</span> <span class="nv">"David"</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>顺序要对应但可以不和表中一样</li>
  <li>允许值为 NULL 的column可以不写，会被写入NULL</li>
  <li>要注意有些column限制了值不能为 NULL</li>
</ul>

<p><strong>Inserting multiple rows</strong></p>

<p>基本用法：
VALUES后跟多个括号，一个括号一行，用逗号分隔</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="k">column</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">column</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...)</span> <span class="k">VALUES</span>
  <span class="p">(</span><span class="o">&lt;</span><span class="n">value</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">value</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...),</span>
  <span class="p">(</span><span class="o">&lt;</span><span class="n">value</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">value</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...),</span>
  <span class="p">(</span><span class="o">&lt;</span><span class="n">value</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">value</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">...);</span>
</code></pre></div></div>

<h3 id="33-update-类句法">3.3 Update 类句法</h3>

<p><strong>修改整个一列column的值</strong></p>

<p>keywords</p>

<ul>
  <li>UPDATE</li>
  <li>SET</li>
</ul>

<p>基本句法</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">SET</span> <span class="o">&lt;</span><span class="k">column</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<p>如果要更新多个 column:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">SET</span> <span class="o">&lt;</span><span class="k">column</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">value</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">column</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">value</span> <span class="mi">2</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<p>比如</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">books</span> <span class="k">SET</span> <span class="n">author</span> <span class="o">=</span> <span class="s1">'Dave'</span><span class="p">,</span> <span class="n">genre</span> <span class="o">=</span> <span class="s1">'tragedy'</span><span class="p">;</span>
</code></pre></div></div>

<p>会把 books 表里所有数据的 author 改为 ‘Dave’， genre 会全部变成 ‘tragedy’。</p>

<p><strong>修改指定row的数据</strong></p>

<p>keywords:</p>
<ul>
  <li>UPDATE</li>
  <li>SET</li>
  <li>WHERE</li>
</ul>

<p>基本句法：</p>

<p>思路是在后面加上 WHERE condition 匹配指定的rows</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">SET</span> <span class="o">&lt;</span><span class="k">column</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="n">condition</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<p>当然也可以修改指定row的多个column， 条件式也可以加上逻辑组合</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">SET</span> <span class="o">&lt;</span><span class="k">column</span> <span class="mi">1</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">value</span> <span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="k">column</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">value</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="n">condition1</span><span class="o">&gt;</span> <span class="k">AND</span> <span class="o">&lt;</span><span class="n">condition2</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="34-delete-类句法">3.4 Delete 类句法</h3>

<p><strong>keywords</strong></p>

<ul>
  <li>DELETE</li>
  <li>WHERE</li>
</ul>

<p><strong>删除所有rows</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DELETE</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<p><strong>删除指定rows</strong></p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">DELETE</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">&gt;</span> <span class="k">WHERE</span> <span class="o">&lt;</span><span class="n">condition</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="4-使用-transaction-处理可能出现的错误">4 使用 transaction 处理可能出现的错误</h3>

<p>数据库在进行数据的 CRUD 操作时，默认是autocommit。也就是写的statement会默认直接写到存储介质上。但实际情况是出错不可避免会出错，或者在进行多条数据注入时突然断电或死机等情况。</p>

<p>为了解决这种情况数据库应用了transaction机制，一次transaction中可以包含多个statements，其中任何一个地方出错都会导致整个transaction回撤，让数据库回到transaction之前的状态。</p>

<p>基本句法是用 <code class="language-plaintext highlighter-rouge">BEGIN;</code> 和 <code class="language-plaintext highlighter-rouge">COMMIT;</code> 包裹statements：</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">BEGIN</span><span class="p">;</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="p">...</span>
<span class="k">UPDATE</span> <span class="p">...</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="k">COMMIT</span><span class="p">;</span>
</code></pre></div></div>

<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fpf0wayc9zj30kw09f0tc.jpg" alt="" /></p>

<h4 id="数据的回滚---rolling-back-from-transactions">数据的回滚 - Rolling Back from Transactions</h4>

<p>让数据库回到transaction之前的状态</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">BEGIN</span><span class="p">;</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="p">...</span>
<span class="k">UPDATE</span> <span class="p">...</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="p">.</span>
<span class="k">ROLLBACK</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="5-databases-with-frameworks">5 Databases with Frameworks</h3>

<p>实际开发中不常见直接在程序中使用 SQL 原生语句的情况，多数情况下都使用编程语言专有的针对数据库的library，将其转译为SQL，这类库叫 ORM - Object-Relation Mapping，Rails用到的 <a href="http://api.rubyonrails.org/classes/ActiveRecord/Base.html">ActiveRecord</a> 就是其中一种。</p>

<p><a href="https://en.wikipedia.org/wiki/Object-relational_mapping">ORM 的维基页面</a></p>

<blockquote>
  <p>Object-relational mapping (ORM, O/RM, and O/R mapping tool) in computer science is a programming technique for converting data between incompatible type systems using <strong>object-oriented programming languages</strong>. This creates, in effect, a “virtual object database” that can be used from within the programming language.</p>
</blockquote>

<h3 id="datebase-normalization">Datebase Normalization</h3>

<h3 id="datebase-keys">Datebase keys</h3>

<h3 id="table-relationships">Table Relationships</h3>

<h3 id="joining-table-data-with-sql">Joining Table Data with SQL</h3>

<h3 id="set-operations">Set Operations</h3>

<h3 id="subqueries">Subqueries</h3>
